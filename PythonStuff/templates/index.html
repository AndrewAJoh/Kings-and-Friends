<html><head><style>
  body {
    background-color: white
  }
  .button {
    background-color: rgb(128, 128, 128);
    border: none;
    color: black;
    padding: 15px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
  }
  table {
    background-color: white;
    align: center top;
    border: solid;
  }
  td {
    align: center top;
	text-align: center;
  }
  th {
    align: center top;
	text-align: center;
  }
  table, th, td{
	border: 1px solid black;
  }
  .card {
    width: 100px;
    height: 125px;
    align: center;
    valign: center;
	color: black;
  }
  .cardImage {
    width: 100px;
    height: 125px;
  }
  .selector{
    vertical-align: middle;
	margin: 0px;
  }
  #replace{
    width: 100px;
    height: 125px;
    text-align: center;
    margin: auto;

  }

  #currentCard{
    width: 100px;
    height: 125px;
    text-align: center;
    margin: auto;

  }
  #rowHand1,
  #rowHand2 {
    padding=15px;
    background-color: rgb(254, 217, 102);
  }
  .testing_area {
	background-color: rgb(256, 256, 256);
  }
</style>

</head><body>
<div class="wrapper">
  <h1 style="text-align:center">King's Corner</h1>
  <table id="bodytable" style="width:100%;padding:15px; border:none;">
    <tbody><tr align="center" valign="top">
      <th id="rowscoreBoard">
        <table id="scoreBoard" style="border:solid" align="center top">
          <tbody><tr>
            <th>Username</th>
            <th>Wins</th>
            <th>Cards in Hand</th>
            <th>Turn</th>
          </tr>
          <tr>
            <td id="p1name">d</td>
            <td id="p1wins">0</td>
            <td id="p1numcards">7</td>
            <td id="p1turn"></td>
          </tr>
          <tr>
            <td id="p2name">d</td>
            <td id="p2wins">0</td>
            <td id="p2numcards">8</td>
            <td id="p2turn">X</td>
          </tr>
          <tr>
            <td id="p3name">dd</td>
            <td id="p3wins">0</td>
            <td id="p3numcards">7</td>
            <td id="p3turn"></td>
          </tr>
          <tr>
            <td id="p4name">ddd</td>
            <td id="p4wins">0</td>
            <td id="p4numcards">7</td>
            <td id="p4turn"></td>
          </tr>
        </tbody></table>
        <form action="" id="join" method="POST">
          <p>Username: </p>
            <input type="text" class="username" placeholder="User Name">
			<p>
			<input id="joinbutton" class="button" type="submit" style="width:100%" height="100" value="Join Game">
        </p></form>
		<h2 id="replace">12D</h2>

		<h4 id="selectedTableSpot">13C</h4>
		<form action="" id="placecard" method="POST">
			<input class="selector" type="radio" name="placement" value="NW"> NW
			<input class="selector" type="radio" name="placement" value="N"> N
			<input class="selector" type="radio" name="placement" value="NE"> NE
			<input class="selector" type="radio" name="placement" value="W"> W
			<input class="selector" type="radio" name="placement" value="E"> E
			<input class="selector" type="radio" name="placement" value="SW"> SW
			<input class="selector" type="radio" name="placement" value="S"> S
			<input class="selector" type="radio" name="placement" value="SE"> SE
			<input type="submit" class="button" value="Place Card"> <p>
		</p></form>
		<form action="" id="movepile" method="POST">
		  <select id="StartPile">
			<option value="NW">NW</option>
			<option value="N">N</option>
			<option value="NE">NE</option>
			<option value="W">W</option>
			<option value="E">E</option>
			<option value="SW">SW</option>
			<option value="S">S</option>
			<option value="SE">SE</option>
		  </select>
		  to
		  <select id="EndPile">
		  	<option value="NW">NW</option>
			<option value="N">N</option>
			<option value="NE">NE</option>
			<option value="W">W</option>
			<option value="E">E</option>
			<option value="SW">SW</option>
			<option value="S">S</option>
			<option value="SE">SE</option>
		  </select>
		  <br> <br>
		  <input type="submit" class="button" value="Move Pile"> <p>
		</p></form>
		<form action="" id="endturn" method="POST">
			<input id="endturnbutton" class="button" type="submit" style="width:100%" height="100" value="End Turn">
        </form>
      </th>
      <th id="rowtable" style="border:none;">
        <table id="tablehandsplit" style="width:auto; border-collapse:collapse;">
          <tbody><tr>
            <td colspan="7" id="table" background="/static/photos/tablelogo.png" style="border:solid;background-size:500px;background-position:center">
              <table id="tableArray" style="border:none; background:none;" align="center">
                <tbody><tr id="NN">
                  <td id="NW" class="card"></td>
                  <td id="N" class="card"><img onclick="javascript:placeCardOnClick(&quot;8S&quot;)" src="/static/photos/8S.png" align="center"></td>
                  <td id="NE" class="card"></td>
                </tr>
                <tr id="NS">
                  <td id="W" class="card"><img onclick="javascript:placeCardOnClick(&quot;13C&quot;)" src="/static/photos/13C.png" align="center"></td>
                  <td id="Deck" class="card">
                    <img src="/static/photos/cardDeck.png">
	<!--	    <h2>Deck</h2>-->
                  </td>
                  <td id="E" class="card"><img onclick="javascript:placeCardOnClick(&quot;2S&quot;)" src="/static/photos/2S.png" align="center"></td>
                </tr>
                <tr id="SS">
                  <td id="SW" class="card"></td>
                  <td id="S" class="card"><img onclick="javascript:placeCardOnClick(&quot;2H&quot;)" src="/static/photos/2H.png" align="center"></td>
                  <td id="SE" class="card"></td>
                </tr>
              </tbody></table>
            </td>
          </tr>
          <tr>
            <td id="hand">
              <table id="tableHand" style="border:none" align="center">
                <tbody><tr id="rowHand1">
                  <td id="cardspot0" class="card"><br> <img onclick="javascript:givePlayerOptions(&quot;8D&quot;)" src="/static/photos/8D.png" align="center"></td>
                  <td id="cardspot1" class="card"><br> <img onclick="javascript:givePlayerOptions(&quot;6S&quot;)" src="/static/photos/6S.png" align="center"></td>
                  <td id="cardspot2" class="card"><br> <img onclick="javascript:givePlayerOptions(&quot;1D&quot;)" src="/static/photos/1D.png" align="center"></td>
                  <td id="cardspot3" class="card"><br> <img onclick="javascript:givePlayerOptions(&quot;3D&quot;)" src="/static/photos/3D.png" align="center"></td>
                  <td id="cardspot4" class="card"><br> <img onclick="javascript:givePlayerOptions(&quot;8H&quot;)" src="/static/photos/8H.png" align="center"></td>
                  <td id="cardspot5" class="card"><br> <img onclick="javascript:givePlayerOptions(&quot;5C&quot;)" src="/static/photos/5C.png" align="center"></td>
                  <td id="cardspot6" class="card"><br> <img onclick="javascript:givePlayerOptions(&quot;5H&quot;)" src="/static/photos/5H.png" align="center"></td>
                </tr>
                <tr id="rowHand2">
                  <td id="cardspot7" class="card"></td>
                  <td id="cardspot8" class="card"></td>
                  <td id="cardspot9" class="card"></td>
                  <td id="cardspot10" class="card"></td>
                  <td id="cardspot11" class="card"></td>
                  <td id="cardspot12" class="card"></td>
                  <td id="cardspot13" class="card"></td>
                </tr>
              </tbody></table>
            </td>
          </tr>
        </tbody></table>
      </th>
    </tr>
  </tbody></table>
  <div id="broadcast"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.min.js"></script>
<script type="text/javascript">
	var hand = [];
    var socket = io.connect('http://3.15.183.196:80');
	socket.on( 'connect', function() {
		socket.emit( 'connection', {
			data: 'A new user has connected'
		} )
	} )

	var form = $( '#join' ).on( 'submit', function( e ) {
		e.preventDefault()
		let user_name = $( 'input.username' ).val()
		socket.emit( 'join game', {
			user_name : user_name
		} )
	} )

	var form = $( '#placecard' ).on( 'submit', function( e ) {
		e.preventDefault();
		var card = document.getElementById("replace").innerHTML;
	//	let pile = $( 'input.selector:checked' ).val();
		//console.log("original " + pile);
		let pile = document.getElementById("selectedTableSpot").innerHTML;
		console.log("new " + pile);
		socket.emit( 'place card', {
			input_card : card,
			input_pile : pile
		} )
	} )

	var form = $( '#movepile' ).on( 'submit', function( e ) {
		e.preventDefault();
		let startPile = $( '#StartPile option:selected' ).text();
		let endPile = $( '#EndPile option:selected' ).text();
		socket.emit( 'move pile', {
			start_pile : startPile,
			end_pile : endPile
		} )
	} )

	var form = $( '#endturn' ).on( 'submit', function( e ) {
		e.preventDefault()
		socket.emit( 'end turn' )
	} )

    socket.on( 'game update', function( msg ) {
        console.log( msg );
		document.getElementById("broadcast").innerHTML = "";
        $( 'h3' ).remove();
        $( 'p.message_holder' ).empty().append(msg);
		var gameStatus = JSON.parse(msg);
		if ("error" in gameStatus){
			$( 'p.message_holder' ).empty().append(gameStatus.error);
		}
		else{
			hand = gameStatus.Hand;
			for (i=0; i<4; i++){
				if (typeof gameStatus.Player[i] != "undefined"){
					if (gameStatus.Player[i].inGame == true){
						document.getElementById("p"+(i+1)+"name").innerHTML = gameStatus.Player[i].name;
						var cards = gameStatus.Player[i].numcards;
						document.getElementById("p"+(i+1)+"numcards").innerHTML = cards;

						if (gameStatus.Player[i].name in gameStatus.Winners){
							document.getElementById("p" + (i+1) + "wins").innerHTML = gameStatus.Winners[gameStatus.Player[i].name];
						}
						else{
							document.getElementById("p" + (i+1) + "wins").innerHTML = "0";
						}
					}
					else{
						document.getElementById("p"+(i+1)+"name").innerHTML = "Player" + (i+1);
						document.getElementById("p"+(i+1)+"numcards").innerHTML = "0";
						document.getElementById("p"+(i+1)+"wins").innerHTML = "0";
					}
				}
				else{
					document.getElementById("p"+(i+1)+"name").innerHTML = "Player" + (i+1);
					document.getElementById("p"+(i+1)+"numcards").innerHTML = "0";
					document.getElementById("p"+(i+1)+"wins").innerHTML = "0";
				}

			}

			if (gameStatus.CurrentPlayer == 0 && gameStatus.ActiveGame == true){
				document.getElementById("p1turn").innerHTML = "X";
			}
			else{
				document.getElementById("p1turn").innerHTML = "";
			}
			if (gameStatus.CurrentPlayer == 1 && gameStatus.ActiveGame == true){
				document.getElementById("p2turn").innerHTML = "X";
			}
			else{
				document.getElementById("p2turn").innerHTML = "";
			}
			if (gameStatus.CurrentPlayer == 2 && gameStatus.ActiveGame == true){
				document.getElementById("p3turn").innerHTML = "X";
			}
			else{
				document.getElementById("p3turn").innerHTML = "";
			}
			if (gameStatus.CurrentPlayer == 3 && gameStatus.ActiveGame == true){
				document.getElementById("p4turn").innerHTML = "X";
			}
			else{
				document.getElementById("p4turn").innerHTML = "";
			}

			for (x in gameStatus.Table){
				document.getElementById(x).innerHTML = "";
				for (i in gameStatus.Table[x]){
					//document.getElementById(x).innerHTML += '<br>' + gameStatus.Table[x][i];
					//console.log(gameStatus.Table[x][i]);
					document.getElementById(x).innerHTML = "<img onclick=\"javascript:placeCardOnClick(&quot;" + gameStatus.Table[x][i] + "&quot;)\" src=\"/static/photos/" + gameStatus.Table[x][i] + ".png\" align=center>";
				console.log(document.getElementById(x).innerHTML);
//dont send it to givePlayerOptions send it to the place where you can say NW or N or NE  to place card
				}
			}
		}

		function populateHand(hand){
			for (i=0; i < 14; i++){
				var idString = "cardspot" + i;
				document.getElementById(idString).innerHTML = "";
			}
			for (i=0; i < hand.length; i++){
				var idString = "cardspot" + i;
				var picName = hand[i]["string"];
document.getElementById(idString).innerHTML += "<br> <img onclick=\"javascript:givePlayerOptions(&quot;" + hand[i]["string"] + "&quot;)\" src=\"/static/photos/" + picName + ".png\" align=center>";
			}
			return;
		}
		populateHand(hand);
    })

	socket.on( 'game over', function( msg ) {
		var gameResult = JSON.parse(msg);
		var playerId = gameResult.winnerId;
		var playerName = gameResult.winnerName;
		document.getElementById("broadcast").innerHTML = "The game is over. " + playerName + " won. Click \"Join Game\" to play again.";
	} )

	function givePlayerOptions(cardString){
		document.getElementById("replace").innerHTML = cardString;
		document.getElementById("currentCard").innerHTML = "<img src=\"/static/photos/" + cardString + ".png\" align=center>";
	}
   	function placeCardOnClick(cardString){
		console.log("peep " + cardString);
		document.getElementById("selectedTableSpot").innerHTML = cardString; //"<img src=\"/static/photos/" + "cardString" + ".png\" align=center>";
 	}
</script>

<pre><div class="testing_area">DEBUGGING BELOW
<p class="message_holder">{
    "ActiveGame": true,
    "Deck": [
        "11C",
        "6C",
        "3H",
        "7H",
        "13S",
        "7C",
        "4H",
        "6D",
        "12H",
        "2D",
        "13H",
        "10C",
        "11H",
        "4C",
        "12S",
        "10S",
        "5D",
        "9H"
    ],
    "Hand": [
        {
            "color": "R",
            "position": 0,
            "string": "8D",
            "value": 8,
            "suit": "D"
        },
        {
            "color": "B",
            "position": 1,
            "string": "6S",
            "value": 6,
            "suit": "S"
        },
        {
            "color": "R",
            "position": 3,
            "string": "1D",
            "value": 1,
            "suit": "D"
        },
        {
            "color": "R",
            "position": 4,
            "string": "3D",
            "value": 3,
            "suit": "D"
        },
        {
            "color": "R",
            "position": 5,
            "string": "8H",
            "value": 8,
            "suit": "H"
        },
        {
            "color": "B",
            "position": 6,
            "string": "5C",
            "value": 5,
            "suit": "C"
        },
        {
            "color": "R",
            "position": 7,
            "string": "5H",
            "value": 5,
            "suit": "H"
        }
    ],
    "Player": [
        {
            "inGame": true,
            "name": "d",
            "playerId": 0,
            "isTurn": false,
            "numcards": 7
        },
        {
            "inGame": true,
            "name": "d",
            "playerId": 1,
            "isTurn": true,
            "numcards": 8
        },
        {
            "inGame": true,
            "name": "dd",
            "playerId": 2,
            "isTurn": false,
            "numcards": 7
        },
        {
            "inGame": true,
            "name": "ddd",
            "playerId": 3,
            "isTurn": false,
            "numcards": 7
        }
    ],
    "Winners": {},
    "Table": {
        "E": [
            "2S"
        ],
        "SW": [],
        "NE": [],
        "N": [
            "8S"
        ],
        "S": [
            "2H"
        ],
        "W": [
            "13C"
        ],
        "SE": [],
        "NW": []
    },
    "CurrentPlayer": 1
}</p>
</div>
</pre>
</div>


</body></html>
